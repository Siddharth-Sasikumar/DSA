<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Smart Home Voice Control with Trie</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #F5F7FA;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      transition: background 0.5s ease-in-out;
    }
    .dashboard {
      background: white;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      width: 600px;
      text-align: center;
    }
    h1 {
      margin-bottom: 15px;
      font-size: 22px;
    }
    input {
      width: 70%;
      padding: 10px;
      margin: 5px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    button {
      padding: 8px 16px;
      margin: 5px;
      border: none;
      border-radius: 8px;
      background: #007BFF;
      color: white;
      cursor: pointer;
      transition: transform 0.2s;
    }
    button:hover {
      transform: scale(1.05);
      background: #0056b3;
    }
    .appliances {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-top: 20px;
    }
    .box {
      background: #f0f0f0;
      padding: 20px;
      border-radius: 12px;
      min-height: 120px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      transition: background 0.5s, box-shadow 0.5s;
    }
    .label {
      margin-top: 8px;
      font-size: 14px;
      font-weight: bold;
    }
    /* Animations */
    .light-on {
      background: #fff8c2;
      box-shadow: 0 0 20px yellow;
    }
    .fan-spin {
      display: inline-block;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      from { transform: rotate(0); }
      to { transform: rotate(360deg); }
    }
    .car-move {
      animation: moveCar 2s linear infinite;
    }
    @keyframes moveCar {
      0% { transform: translateX(-20px); }
      50% { transform: translateX(20px); }
      100% { transform: translateX(-20px); }
    }
    .cctv-on {
      position: relative;
      font-size: 40px;
      animation: cctv-blink 1s infinite;
    }
    @keyframes cctv-blink {
      0%, 100% { color: red; }
      50% { color: darkred; }
    }
  </style>
</head>
<body>
  <div class="dashboard">
    <h1>üé§ Smart Home Voice Control with Trie</h1>
    <input type="text" id="commandInput" placeholder="Enter command (e.g., light on)" />
    <button onclick="startRecognition()">üéôÔ∏è Speak</button>
    <button onclick="executeCommand()">‚ñ∂Ô∏è Execute</button>

    <div class="appliances">
      <div class="box" id="lightBox">üí°<div class="label">Light</div></div>
      <div class="box" id="fanBox">üåÄ<div class="label">Fan</div></div>
      <div class="box" id="gateBox">üîí<div class="label">Gate</div></div>
      <div class="box" id="carBox">üöó<div class="label">Car</div></div>
      <div class="box" id="cctvBox">üìπ<div class="label">CCTV</div></div>
    </div>
  </div>

  <script>
    // Trie Node class
    class TrieNode {
      constructor() {
        this.children = {};
        this.isEndOfCommand = false;
        this.action = null; // store action string at command end
      }
    }

    // Trie class
    class Trie {
      constructor() {
        this.root = new TrieNode();
      }

      // Insert command and action into trie
      insert(commandWords, action) {
        let node = this.root;
        for (const word of commandWords) {
          if (!node.children[word]) {
            node.children[word] = new TrieNode();
          }
          node = node.children[word];
        }
        node.isEndOfCommand = true;
        node.action = action;
      }

      // Search command in trie
      search(commandWords) {
        let node = this.root;
        for (const word of commandWords) {
          if (!node.children[word]) {
            return null;
          }
          node = node.children[word];
        }
        if (node.isEndOfCommand) {
          return node.action;
        }
        return null;
      }
    }

    // Normalize and sort words alphabetically for consistent matching
    function normalize(cmd) {
      return cmd.trim().toLowerCase().split(/\s+/).sort();
    }

    // Create trie instance
    const commandTrie = new Trie();

    // Insert commands and actions into the trie (same variations as before)
    const commandActions = {
      "turn on light": "light on",
      "light on": "light on",
      "on light": "light on",
      "switch on light": "light on",
      "switch light on": "light on",

      "turn off light": "light off",
      "light off": "light off",
      "off light": "light off",
      "switch off light": "light off",
      "switch light off": "light off",

      "turn on fan": "fan on",
      "fan on": "fan on",
      "on fan": "fan on",
      "switch on fan": "fan on",
      "switch fan on": "fan on",

      "turn off fan": "fan off",
      "fan off": "fan off",
      "off fan": "fan off",
      "switch off fan": "fan off",
      "switch fan off": "fan off",

      "open gate": "gate open",
      "gate open": "gate open",
      "unlock gate": "gate open",
      "open the gate": "gate open",

      "close gate": "gate close",
      "gate close": "gate close",
      "lock gate": "gate close",
      "close the gate": "gate close",

      "turn on car": "car on",
      "car on": "car on",
      "on car": "car on",
      "switch on car": "car on",
      "switch car on": "car on",

      "stop car": "car stop",
      "car stop": "car stop",
      "halt car": "car stop",
      "stop the car": "car stop",

      "turn on cctv": "cctv on",
      "cctv on": "cctv on",
      "on cctv": "cctv on",
      "switch on cctv": "cctv on",
      "switch cctv on": "cctv on",

      "turn off cctv": "cctv off",
      "cctv off": "cctv off",
      "off cctv": "cctv off",
      "switch off cctv": "cctv off",
      "switch cctv off": "cctv off"
    };

    // Insert all commands in trie after normalizing and splitting
    Object.entries(commandActions).forEach(([command, action]) => {
      const words = normalize(command);
      commandTrie.insert(words, action);
    });

    function animateFeedback(type) {
      const lightBox = document.getElementById("lightBox");
      const fanBox = document.getElementById("fanBox");
      const gateBox = document.getElementById("gateBox");
      const carBox = document.getElementById("carBox");
      const cctvBox = document.getElementById("cctvBox");

      // Reset background of all boxes
      lightBox.style.background = "#f0f0f0";
      fanBox.style.background = "#f0f0f0";
      gateBox.style.background = "#f0f0f0";
      carBox.style.background = "#f0f0f0";
      cctvBox.style.background = "#f0f0f0";

      switch (type) {
        case "light on":
          lightBox.classList.add("light-on");
          lightBox.style.background = "#d3d3d3";
          break;
        case "light off":
          lightBox.classList.remove("light-on");
          break;

        case "fan on":
          fanBox.innerHTML = `<span class="fan-spin">üåÄ</span><div class="label">Fan</div>`;
          fanBox.style.background = "#d3d3d3";
          break;
        case "fan off":
          fanBox.innerHTML = `üåÄ<div class="label">Fan</div>`;
          break;

        case "gate open":
          gateBox.innerHTML = `üîì<div class="label">Gate</div>`;
          gateBox.style.background = "#d3d3d3";
          break;
        case "gate close":
          gateBox.innerHTML = `üîí<div class="label">Gate</div>`;
          break;

        case "car on":
          carBox.innerHTML = `<span class="car-move">üöó</span><div class="label">Car</div>`;
          carBox.style.background = "#d3d3d3";
          break;
        case "car stop":
          carBox.innerHTML = `üöó<div class="label">Car</div>`;
          break;

        case "cctv on":
          cctvBox.innerHTML = `<span class="cctv-on">üìπ</span><div class="label">CCTV</div>`;
          cctvBox.style.background = "#d3d3d3";
          break;
        case "cctv off":
          cctvBox.innerHTML = `üìπ<div class="label">CCTV</div>`;
          break;

        default:
          alert("‚ùå Unknown command");
      }
    }

    function executeCommand() {
      const input = document.getElementById("commandInput").value.toLowerCase().trim();
      const normalizedWords = normalize(input);
      const action = commandTrie.search(normalizedWords);
      if (action) {
        animateFeedback(action);
      } else {
        alert("‚ùå Command not recognized");
      }
    }

    function startRecognition() {
      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = "en-US";
      recognition.continuous = false;
      recognition.interimResults = false;

      recognition.start();

      recognition.onresult = function(event) {
        const command = event.results[0][0].transcript.toLowerCase();
        document.getElementById("commandInput").value = command;
        const normalizedWords = normalize(command);
        const action = commandTrie.search(normalizedWords);
        if (action) {
          animateFeedback(action);
        } else {
          alert("‚ùå Command not recognized");
        }
      };
    }
  </script>
</body>
</html>
